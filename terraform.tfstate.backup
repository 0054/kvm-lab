{
  "version": 4,
  "terraform_version": "0.12.12",
  "serial": 73,
  "lineage": "0d17e183-ce4f-64b1-f127-fdd2ce95e387",
  "outputs": {},
  "resources": [
    {
      "mode": "data",
      "type": "template_file",
      "name": "network_config",
      "each": "map",
      "provider": "provider.template",
      "instances": [
        {
          "index_key": "centos-vm1",
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "becc85dda7ec7afb2d10c98118cf0cd48dbee6fac87757eb9516c530644ed4d1",
            "rendered": "network:\n  version: 2\n  config:\n  - type: physical\n    name: eth0\n    subnets:\n      - type: static\n        address: 10.10.1.11\n        netmask: 255.255.255.0\n        gateway: 10.10.1.1\n",
            "template": "network:\n  version: 2\n  config:\n  - type: physical\n    name: eth0\n    subnets:\n      - type: static\n        address: ${ip}\n        netmask: 255.255.255.0\n        gateway: 10.10.1.1\n",
            "vars": {
              "ip": "10.10.1.11"
            }
          }
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "user_data",
      "provider": "provider.template",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "feda6350effe0e8d3fdbe91b4ad2b6b0baf9c6ed98d173e32c37b8237a606327",
            "rendered": "#cloud-config\n# ssh_pwauth: True\n# chpasswd:\n#   list: |\n#      root:q1q1q1\n#   expire: False\nusers:\n  - name: centos\n    groups: wheel\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    ssh-authorized-keys:\n      - \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCrAwyFFAjhjdPN7foZCRYiZSNXGME7aImb46hcBVuVBASs7p0FevJ5xa5ZSP9KdG4py5cSGwtkFLt4nTRu5XLgTbuS2+1JuH0HfqnQ1UMthhrBJualay92cr+ZHyASkUoYzqC44372O0juMhgffqSn1a9tsjM4xwL9beS2upxrY+Hy4evf2i6qymqmOXDZeOxzFgdGUUitV5dOaxAPvv9xP8QkgtgTzsicnP3fUl7tUMtt22keTCm3aG1l4NGrqmJ0dlxwI5W0T6OCmahQsCcC7TPqE9sMNehaCRlQnJ+6ioWv8zjCSOTLG1jEeL6RyPThcVR1sl5IVX23+6cPIXe9 mint@home\n\"\nwrite_files:\n  - path: \"/etc/sysctl.conf\"\n    owner: root\n    content: |\n      net.ipv6.conf.all.disable_ipv6=1\n      net.ipv6.conf.default.disable_ipv6=1\nmanage_resolv_conf: true\nresolv_conf:\n  domain: kvm.lab\ngrowpart:\n  mode: auto\n  devices: ['/']\nruncmd:\n- sysctl -p\n- timedatectl set-timezone Europe/Moscow\n- timedatectl set-ntp true\n",
            "template": "#cloud-config\n# ssh_pwauth: True\n# chpasswd:\n#   list: |\n#      root:q1q1q1\n#   expire: False\nusers:\n  - name: centos\n    groups: wheel\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    ssh-authorized-keys:\n      - \"${rsa_pub}\"\nwrite_files:\n  - path: \"/etc/sysctl.conf\"\n    owner: root\n    content: |\n      net.ipv6.conf.all.disable_ipv6=1\n      net.ipv6.conf.default.disable_ipv6=1\nmanage_resolv_conf: true\nresolv_conf:\n  domain: kvm.lab\ngrowpart:\n  mode: auto\n  devices: ['/']\nruncmd:\n- sysctl -p\n- timedatectl set-timezone Europe/Moscow\n- timedatectl set-ntp true\n",
            "vars": {
              "rsa_pub": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCrAwyFFAjhjdPN7foZCRYiZSNXGME7aImb46hcBVuVBASs7p0FevJ5xa5ZSP9KdG4py5cSGwtkFLt4nTRu5XLgTbuS2+1JuH0HfqnQ1UMthhrBJualay92cr+ZHyASkUoYzqC44372O0juMhgffqSn1a9tsjM4xwL9beS2upxrY+Hy4evf2i6qymqmOXDZeOxzFgdGUUitV5dOaxAPvv9xP8QkgtgTzsicnP3fUl7tUMtt22keTCm3aG1l4NGrqmJ0dlxwI5W0T6OCmahQsCcC7TPqE9sMNehaCRlQnJ+6ioWv8zjCSOTLG1jEeL6RyPThcVR1sl5IVX23+6cPIXe9 mint@home\n"
            }
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_cloudinit_disk",
      "name": "commoninit",
      "each": "map",
      "provider": "provider.libvirt",
      "instances": [
        {
          "index_key": "centos-vm1",
          "schema_version": 0,
          "attributes": {
            "id": "/kvm-pool/terraform_pool/centos-vm1_cloudinit.iso;5dc9c288-849e-f599-0af5-65edfa8b538c",
            "meta_data": "",
            "name": "centos-vm1_cloudinit.iso",
            "network_config": "network:\n  version: 2\n  config:\n  - type: physical\n    name: eth0\n    subnets:\n      - type: static\n        address: 10.10.1.11\n        netmask: 255.255.255.0\n        gateway: 10.10.1.1\n",
            "pool": "terraform_pool",
            "user_data": "#cloud-config\n# ssh_pwauth: True\n# chpasswd:\n#   list: |\n#      root:q1q1q1\n#   expire: False\nusers:\n  - name: centos\n    groups: wheel\n    shell: /bin/bash\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    ssh-authorized-keys:\n      - \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCrAwyFFAjhjdPN7foZCRYiZSNXGME7aImb46hcBVuVBASs7p0FevJ5xa5ZSP9KdG4py5cSGwtkFLt4nTRu5XLgTbuS2+1JuH0HfqnQ1UMthhrBJualay92cr+ZHyASkUoYzqC44372O0juMhgffqSn1a9tsjM4xwL9beS2upxrY+Hy4evf2i6qymqmOXDZeOxzFgdGUUitV5dOaxAPvv9xP8QkgtgTzsicnP3fUl7tUMtt22keTCm3aG1l4NGrqmJ0dlxwI5W0T6OCmahQsCcC7TPqE9sMNehaCRlQnJ+6ioWv8zjCSOTLG1jEeL6RyPThcVR1sl5IVX23+6cPIXe9 mint@home\n\"\nwrite_files:\n  - path: \"/etc/sysctl.conf\"\n    owner: root\n    content: |\n      net.ipv6.conf.all.disable_ipv6=1\n      net.ipv6.conf.default.disable_ipv6=1\nmanage_resolv_conf: true\nresolv_conf:\n  domain: kvm.lab\ngrowpart:\n  mode: auto\n  devices: ['/']\nruncmd:\n- sysctl -p\n- timedatectl set-timezone Europe/Moscow\n- timedatectl set-ntp true\n"
          },
          "private": "bnVsbA==",
          "depends_on": [
            "data.template_file.network_config",
            "data.template_file.user_data",
            "libvirt_pool.terraform_pool"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_domain",
      "name": "vms",
      "each": "map",
      "provider": "provider.libvirt",
      "instances": [
        {
          "index_key": "centos-vm1",
          "schema_version": 0,
          "attributes": {
            "arch": "x86_64",
            "autostart": false,
            "boot_device": [
              {
                "dev": [
                  "hd",
                  "network"
                ]
              }
            ],
            "cloudinit": "/kvm-pool/terraform_pool/centos-vm1_cloudinit.iso;5dc9c288-849e-f599-0af5-65edfa8b538c",
            "cmdline": null,
            "console": [
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "0",
                "target_type": "serial",
                "type": "pty"
              },
              {
                "source_host": "127.0.0.1",
                "source_path": "",
                "source_service": "0",
                "target_port": "1",
                "target_type": "virtio",
                "type": "pty"
              }
            ],
            "coreos_ignition": null,
            "cpu": null,
            "disk": [
              {
                "file": "",
                "scsi": true,
                "url": "",
                "volume_id": "/kvm-pool/terraform_pool/centos-vm1_disk",
                "wwn": ""
              }
            ],
            "emulator": "/usr/bin/kvm-spice",
            "filesystem": [],
            "firmware": "",
            "fw_cfg_name": "opt/com.coreos/config",
            "graphics": [
              {
                "autoport": true,
                "listen_address": "127.0.0.1",
                "listen_type": "address",
                "type": "spice"
              }
            ],
            "id": "2998a868-5c23-4306-8cc1-1871ac601b1e",
            "initrd": "",
            "kernel": "",
            "machine": "ubuntu",
            "memory": 512,
            "metadata": null,
            "name": "centos-vm1",
            "network_interface": [
              {
                "addresses": [
                  "10.10.1.11"
                ],
                "bridge": "",
                "hostname": "centos-vm1",
                "mac": "52:54:00:A6:2F:45",
                "macvtap": "",
                "network_id": "d200a714-8d91-42a0-bd9e-b0f27a494e25",
                "network_name": "terraform_network",
                "passthrough": "",
                "vepa": "",
                "wait_for_lease": true
              }
            ],
            "nvram": [],
            "qemu_agent": false,
            "running": true,
            "timeouts": null,
            "vcpu": 1,
            "video": [],
            "xml": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDB9fQ==",
          "depends_on": [
            "libvirt_cloudinit_disk.commoninit",
            "libvirt_network.terraform_network",
            "libvirt_volume.vm_disk"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_network",
      "name": "terraform_network",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "addresses": [
              "10.10.1.0/24"
            ],
            "autostart": true,
            "bridge": "virbr2",
            "dhcp": [],
            "dns": [
              {
                "enabled": true,
                "forwarders": [],
                "hosts": [],
                "local_only": false,
                "srvs": []
              }
            ],
            "domain": "kvm.lab",
            "id": "d200a714-8d91-42a0-bd9e-b0f27a494e25",
            "mode": "nat",
            "mtu": null,
            "name": "terraform_network",
            "routes": [],
            "xml": []
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_pool",
      "name": "terraform_pool",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "allocation": 7770488832,
            "available": null,
            "capacity": 245058293760,
            "id": "4c718abb-b9e3-4829-a981-9cf6c63a3156",
            "name": "terraform_pool",
            "path": "/kvm-pool/terraform_pool",
            "type": "dir",
            "xml": []
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "centos_template",
      "provider": "provider.libvirt",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "base_volume_id": null,
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/kvm-pool/terraform_pool/centos_template",
            "name": "centos_template",
            "pool": "terraform_pool",
            "size": 8589934592,
            "source": "/kvm-pool/images/CentOS-7-x86_64-GenericCloud-1907.qcow2",
            "xml": []
          },
          "private": "bnVsbA==",
          "depends_on": [
            "libvirt_pool.terraform_pool"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "libvirt_volume",
      "name": "vm_disk",
      "each": "map",
      "provider": "provider.libvirt",
      "instances": [
        {
          "index_key": "centos-vm1",
          "schema_version": 0,
          "attributes": {
            "base_volume_id": "/kvm-pool/terraform_pool/centos_template",
            "base_volume_name": null,
            "base_volume_pool": null,
            "format": "qcow2",
            "id": "/kvm-pool/terraform_pool/centos-vm1_disk",
            "name": "centos-vm1_disk",
            "pool": "terraform_pool",
            "size": 10737418240,
            "source": null,
            "xml": []
          },
          "private": "bnVsbA==",
          "depends_on": [
            "libvirt_pool.terraform_pool",
            "libvirt_volume.centos_template"
          ]
        }
      ]
    }
  ]
}
